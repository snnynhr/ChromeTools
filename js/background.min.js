console.log("Initiating background process");null===localStorage.getItem("cookiesWL")&&localStorage.setItem("cookiesWL",JSON.stringify([]));null===localStorage.getItem("historyWL")&&localStorage.setItem("historyWL",JSON.stringify([]));null===localStorage.getItem("tabStack")&&localStorage.setItem("tabStack",JSON.stringify([]));null===localStorage.getItem("sessionStack")&&localStorage.setItem("sessionStack",JSON.stringify([]));
null===localStorage.getItem("cookiesFlag")&&localStorage.setItem("cookiesFlag",1);null===localStorage.getItem("historyFlag")&&localStorage.setItem("historyFlag",1);null===localStorage.getItem("hd")&&localStorage.setItem("hd","on");null===localStorage.getItem("ytSize")&&localStorage.setItem("ytSize","1");null===localStorage.getItem("ytQuality")&&localStorage.setItem("ytQuality","highres");
chrome.a.n({},function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];b[b.length]=[d.id,d.e,d.index,d.url,d.b,d.d]}localStorage.setItem("chromeSession",JSON.stringify(b))});chrome.a.i.addListener(function(a){curr=JSON.parse(localStorage.getItem("chromeSession"));curr[curr.length]=[a.id,a.e,a.index,a.url,a.b,a.d];console.log(curr);localStorage.setItem("chromeSession",JSON.stringify(curr))});
chrome.a.k.addListener(function(a){curr=JSON.parse(localStorage.getItem("chromeSession"));for(var b=0;b<curr.length;b++)if(curr[b][0]==a){curr.splice(b,1);break}console.log(curr);localStorage.setItem("chromeSession",JSON.stringify(curr))});chrome.a.l.addListener(function(a,b){if(void 0!==b.url){console.log(a+" "+b.url);curr=JSON.parse(localStorage.getItem("chromeSession"));for(var c=0;c<curr.length;c++)if(curr[c][0]==a){curr[c][3]=b.url;break}localStorage.setItem("chromeSession",JSON.stringify(curr))}});
chrome.g.h.addListener(function(a){"explicit"==a.f&&localStorage.setItem("cookiesFlag",1)});chrome.history.m.addListener(function(){localStorage.setItem("historyFlag",1)});chrome.o.j.addListener(function(a,b,c){if("getSettings"==a.c){a="on"==localStorage.getItem("hd")?"1":"0";b=localStorage.getItem("ytSize");var d=localStorage.getItem("ytQuality");c({p:d,q:b,enabled:a})}else console.log(a.c)});
